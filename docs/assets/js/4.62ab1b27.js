(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{385:function(t,e,a){t.exports=a.p+"assets/img/2020-05-31-21-12-57.f8d04cf8.png"},386:function(t,e,a){t.exports=a.p+"assets/img/2020-05-31-22-26-06.ae13f613.png"},387:function(t,e,a){t.exports=a.p+"assets/img/2020-05-31-23-11-32.78cb3304.png"},388:function(t,e,a){t.exports=a.p+"assets/img/2020-05-31-23-18-55.ab5f6eef.png"},389:function(t,e){t.exports="data:image/png;base64,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"},390:function(t,e,a){t.exports=a.p+"assets/img/2020-06-01-16-45-03.fa9cdea5.png"},391:function(t,e,a){t.exports=a.p+"assets/img/2020-06-01-16-28-11.4bcd49bc.png"},392:function(t,e,a){t.exports=a.p+"assets/img/2020-06-01-16-28-26.a0d0b5ad.png"},420:function(t,e,a){"use strict";a.r(e);var n=a(45),s=Object(n.a)({},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("p",[n("a",{attrs:{href:"https://www.52pojie.cn/thread-350397-1-1.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("od下载"),n("OutboundLink")],1)]),t._v(" "),n("h1",{attrs:{id:"切出游戏窗口时-删除暂停事件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#切出游戏窗口时-删除暂停事件"}},[t._v("#")]),t._v(" 切出游戏窗口时，删除暂停事件")]),t._v(" "),n("blockquote",[n("p",[t._v("解决思路，在暂停事件的窗口上，有固定的文本，在程序中找到这个固定的文本")])]),t._v(" "),n("p",[n("img",{attrs:{src:a(385),alt:""}})]),t._v(" "),n("ol",[n("li",[n("p",[t._v("先使用ollydbg打开游戏，然后f9取消调试状态，让游戏运行起来")])]),t._v(" "),n("li",[n("p",[t._v("点击alt+e打开模块窗口")])]),t._v(" "),n("li",[n("p",[t._v("双击游戏的主模块(进程模块)")])]),t._v(" "),n("li",[n("p",[t._v("进入后右键中文查找，没进去的话，多点几次\n"),n("img",{attrs:{src:a(386),alt:""}})])]),t._v(" "),n("li",[n("p",[t._v("运行后，会将程序中的中文字符串查询出来")])]),t._v(" "),n("li",[n("p",[t._v("找到相关的文本行，点击进入，按"),n("code",[t._v("ctrl+a")]),t._v("分析代码")])]),t._v(" "),n("li",[n("p",[t._v("可以看到一个函数，这个函数基本就是一个事件")])]),t._v(" "),n("li",[n("p",[t._v("可以找到函数头，然后直接ret，反汇编的函数头一般都是:")])])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("push ebp\nmov ebp,esp\n")])])]),n("h2",{attrs:{id:"获取阳光和使用阳光"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#获取阳光和使用阳光"}},[t._v("#")]),t._v(" 获取阳光和使用阳光")]),t._v(" "),n("ol",[n("li",[t._v("使用ce附加进程，找到阳光值，然后查看是什么访问了该地址，找出使用和添加的代码地址")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("// 添加阳光的代码\n0044BA45 - 01 87 78550000  - add [edi+00005578],eax\n\n// 使用阳光的代码\n00433F86 - 89 B7 78550000  - mov [edi+00005578],esi\n")])])]),n("ol",{attrs:{start:"2"}},[n("li",[t._v("先查看添加阳光的反汇编区域，可以使用ce或则od")])]),t._v(" "),n("p",[n("img",{attrs:{src:a(387),alt:""}})]),t._v(" "),n("p",[t._v("我使用od打开后，"),n("code",[t._v("ztrl+g")]),t._v("找到0044BA45这个地址，然后加断点，当添加阳光后，可以看到右边eax的值是0x19也就是十进制25")]),t._v(" "),n("p",[t._v("我们现在可以强制写入9999，每次执行到这里都会写入固定额数据：")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("add dword ptr ds:[edi+0x5578],0x3E7\n")])])]),n("ol",{attrs:{start:"3"}},[n("li",[t._v("查找使用阳光值一也是一样的，找到代码后打断点，在执行\n"),n("img",{attrs:{src:a(388),alt:""}})])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("mov esi,[edi+0x5578]\n...\nsub esi, ebx\nmov [edi+0x5578], esi\n")])])]),n("p",[t._v("上面的图片可以看到 ebx=0x96，计算后的esi=0x383")]),t._v(" "),n("p",[t._v("转为现代语言，大概就是：")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("esi = [edi+0x5578] // 获取当前总阳光\nesi = esi - ebx    // 总阳光减去消耗阳光\n[edi+0x5578] = esi // 将计算的新值写到内存中去\n")])])]),n("p",[t._v("只需将每次消耗的阳光改为0，或者删除这个sub指令，即可：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(389),alt:""}})]),t._v(" "),n("p",[t._v("如果在od中要写的写指令大小不够，可以定义一个函数，然后调用")]),t._v(" "),n("ol",[n("li",[t._v("ctrl+b 找到一块空地址，然后在空地址中写函数")]),t._v(" "),n("li",[t._v("将要修改的指令jmp到新的函数地址，函数执行完毕jmp回来执行接下来的逻辑，即可")]),t._v(" "),n("li",[t._v("注入脚本还是ce好用点")])]),t._v(" "),n("h2",{attrs:{id:"植物的冷却时间"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#植物的冷却时间"}},[t._v("#")]),t._v(" 植物的冷却时间")]),t._v(" "),n("p",[t._v("由于每个植物的冷却时间，估计都是调用同一个函数，所以ce注入以下代码后，所有的植物都将无冷却时间:")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('define(address,"PlantsVsZombies.exe"+B2FF0)\ndefine(bytes,3B 47 28 7E 12)\n\n[ENABLE]\nassert(address,bytes)\nalloc(newmem,$1000)\n\nlabel(code)\nlabel(return)\n\nnewmem:\n\ncode:\n  // eax <= 冷却max，那么就进入冷却，删除进入冷却逻辑即可\n  cmp eax,[edi+28]\n  // jle PlantsVsZombies.exe+B3007\n  nop\n  nop\n  jmp return\n\naddress:\n  jmp newmem\nreturn:\n\n[DISABLE]\naddress:\n  db bytes\n  // cmp eax,[edi+28]\n  // jle PlantsVsZombies.exe+B3007\n\ndealloc(newmem)\n')])])]),n("h2",{attrs:{id:"找格子数组"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#找格子数组"}},[t._v("#")]),t._v(" 找格子数组")]),t._v(" "),n("p",[t._v("总之就是一路逆向回去:")]),t._v(" "),n("p",[n("img",{attrs:{src:a(390),alt:""}})]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("// 先找到数组中的某项属性，这里找的是冷却\n\n冷却 = [edi+24]\nedi = eax\neax =  ebx + [edi+15c] + 28\n\n// ebx = 50, 50 arr[] 说明数组的每项大小只有0x50\n// ebx + [edi+15c] 是首地址 [{\n// ebx + [edi+15c] + 28 从首地址开始偏移的属性 [{ attr(首地址到这个属性这里偏移28)\n// 汇编的循环不是通过改变索引，而是通过地址的偏移，比如第0个ebx=0x50*0,第1个ebx=0x50*1,第2个ebx=0x50*2,\n\nedi = 1FDDF058\n扫描 1FDDF058\n0298C800 => 1FDDF058\n是什么访问了 0298C800 \n\nedi = [esi+00000868] <<\nesi = 0298BF98\n扫描 0298BF98\nPlantsVsZombies.exe+3794F8 => 0298BF98\n")])])]),n("p",[t._v("读取格子1:")]),t._v(" "),n("p",[n("img",{attrs:{src:a(391),alt:""}})]),t._v(" "),n("p",[t._v("读取格子2:")]),t._v(" "),n("p",[n("img",{attrs:{src:a(392),alt:""}})]),t._v(" "),n("p",[t._v("想在只需要偏移每个格子的宽度(50)，就能移动下一个格子:")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("[\n  // 首地址 >> 11EE4cb0\n\n  (11EE4cb0+0){\n    attr1,\n    attr2,\n\n    // 11EE4cb0+0+28\n    attr3 = {\n      attr3_attr1,\n\n      // 11EE4cb0+0+28+24\n      attr3_attr2 = 冷却属性存在这里\n    } \n  },\n (11EE4cb0+50){\n    attr1,\n    attr2,\n\n    // 11EE4cb0+50+28\n    attr3 = {\n      attr3_attr1,\n\n      // 11EE4cb0+50+28+24\n      attr3_attr2 = 冷却属性存在这里\n    } \n  },\n  (11EE4cb0+100){\n    attr1,\n    attr2,\n\n    // 11EE4cb0+100+28\n    attr3 = {\n      attr3_attr1,\n\n      // 11EE4cb0+100+28+24\n      attr3_attr2 = 冷却属性存在这里\n    } \n  }\n]\n")])])])])}),[],!1,null,null,null);e.default=s.exports}}]);