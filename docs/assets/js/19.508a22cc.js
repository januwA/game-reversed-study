(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{451:function(n,e,a){"use strict";a.r(e);var r=a(54),t=Object(r.a)({},(function(){var n=this,e=n.$createElement,a=n._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[a("h2",{attrs:{id:"使用线程调用功能"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用线程调用功能"}},[n._v("#")]),n._v(" "),a("a",{attrs:{href:"https://www.youtube.com/watch?v=HYx1vSGeK50&list=PLNffuWEygffbbT9Vz-Y1NXQxv2m6mrmHr&index=60&t=0s",target:"_blank",rel:"noopener noreferrer"}},[n._v("使用线程调用功能"),a("OutboundLink")],1)]),n._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("[ENABLE]\nalloc(callFn,$1000, xxx.exe)\nregistersymbol(callFn)\nCREATETHREAD(callFn) // 功能插入后，创建一个线程去调用，线程只会执行一次\n\ncallFn:\n  push eax\n  push ecx\n  mov eax, [0040C038]\n  inc eax\n  mov [0040C038], eax\n  pop ecx\n  pop eax\n  ret\n\n[DISABLE]\nunregistersymbol(callFn)\ndealloc(callFn)\n")])])]),a("h2",{attrs:{id:"在线程中循环-x86"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在线程中循环-x86"}},[n._v("#")]),n._v(" 在线程中循环 x86")]),n._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("[ENABLE]\nglobalalloc(threadMain,$500)\ncreateThread(threadMain)\n\nlabel(pHp)\nlabel(bRun)\n\n// hp指针\ngame2.exe+B3724:\npHp:\n\nthreadMain:\n  push #20\n  call kernel32.sleep\n\n  mov [pHp],#100\n\n  cmp [bRun],0\n  jne threadMain\n\n  ret\n\nbRun:\n  dd 1\n\nregistersymbol(bRun)\n\n[DISABLE]\nbRun:\n  dd 0\nunregistersymbol(bRun)\n")])])]),a("p",[n._v("关于AA脚本的"),a("a",{attrs:{href:"https://www.cheatengine.org/forum/viewtopic.php?t=579208&sid=3c3ccd4a1da74f1e2c41f8138067e208",target:"_blank",rel:"noopener noreferrer"}},[n._v("睡眠代码"),a("OutboundLink")],1),n._v("：")]),n._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("in 32-bit:\npush #1000\ncall kernel32.sleep\n\nin 64-bit:\nmov ecx,#1000\ncall kernel32.sleep\n")])])]),a("h2",{attrs:{id:"在线程中使用其他脚本定义的符号"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在线程中使用其他脚本定义的符号"}},[n._v("#")]),n._v(" 在线程中使用其他脚本定义的符号")]),n._v(" "),a("p",[n._v("符号脚本：")]),n._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("[ENABLE]\naobscanmodule(yg_INJECT,PlantsVsZombies.exe,8B 87 78 55 00 00 33)\nalloc(newmem,$1000)\n\nglobalalloc(pYg, 4)\npYg:\n dd 0\n\nlabel(return)\n\nnewmem:\n  mov [pYg], edi\n  mov eax,[edi+00005578]\n  jmp return\n\nyg_INJECT:\n  jmp newmem\n  nop\nreturn:\nregistersymbol(yg_INJECT)\n\n[DISABLE]\n\nyg_INJECT:\n  db 8B 87 78 55 00 00\nunregistersymbol(pYg)\ndealloc(pYg)\nunregistersymbol(yg_INJECT)\ndealloc(newmem)\n")])])]),a("p",[n._v("线程脚本:")]),n._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("[ENABLE]\nalloc(incYg, $1000)\nregistersymbol(incYg)\ncreatethread(incYg)\n\nlabel(end)\nregistersymbol(end)\n\nincYg:\n  add [[pYg]+5578], #10\n  push #500\n  call Sleep\n  cmp [end], 0\n  je incYg\n\n  // x64\n  // mov ecx,incYg\n  // sub edx,edx\n  // mov r8d,8000\n\n  // x86\n  // https://forum.cheatengine.org/viewtopic.php?t=575644\n  push 0\n  call GetCurrentThread\n  push eax\n  push 0\n\n  push 8000\n  push 0\n  push incYg\n  push TerminateThread\n  jmp VirtualFree\n\nend:\n  dd 0\n\n[DISABLE]\nend:\n  dd 1\n\nunregistersymbol(incYg)\nunregistersymbol(end)\n// dealloc(incYg)\n")])])]),a("h2",{attrs:{id:"x64-线程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#x64-线程"}},[n._v("#")]),n._v(" x64 线程")]),n._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("[ENABLE]\nalloc(incCounter,$1000)\nregistersymbol(incCounter)\ncreateThread(incCounter)\n\nlabel(mainLoop)\n\nlabel(end)\nregistersymbol(end)\nlabel(counter)\nregistersymbol(counter)\n\n\nincCounter:\n  sub rsp, 0x20\n  jmp mainLoop\n\nmainLoop:\n  // 睡眠500毫秒\n  mov rcx,#500\n  call Sleep\n\n  // counter++\n  inc [counter]\n\n  // 是否结束循环\n  cmp [end],0\n  je mainLoop\n\n  // 清理线程资源\n  add rsp, 0x20\n  mov rcx,incCounter\n  sub rdx,rdx\n  mov r8d,8000\n  jmp VirtualFree\n  ret\n\nend:\n  dd 0\n\ncounter:\n  dd 0\n\n[DISABLE]\nend:\n  dd 1\n\nunregistersymbol(end)\nunregistersymbol(counter)\nunregistersymbol(incCounter)\n")])])]),a("h2",{attrs:{id:"x64-call-messagebox"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#x64-call-messagebox"}},[n._v("#")]),n._v(" x64 call MessageBox")]),n._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("[ENABLE]\nglobalalloc(tmain, $1000)\ncreateThread(tmain)\n \n tmain:\n   push rbp\n   mov rbp,rsp\n\n   sub rsp,#32\n\n   mov rcx,0\n   mov rdx,0\n   mov r8,0\n   mov r9,0\n\n   mov rax,user32.MessageBoxA\n   call rax\n\n   add rsp,#32\n\n   mov rsp,rbp\n   pop rbp\n   ret\n[DISABLE]\n")])])])])}),[],!1,null,null,null);e.default=t.exports}}]);